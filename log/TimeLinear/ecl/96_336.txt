Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_336          Model:              TimeLinear          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.01                
  Des:                Exp                 Loss:               mse                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_336_TimeLinear_custom_ftM_ttHDDWSY_rda8_rdb1_ksize5_beta0.1_freqh_ebtimeF_bs16_Exp_2020>>>>>>>>>>>>>>>>>>>>>>>>>>
Parameters: 228765
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3288149
	speed: 0.0328s/iter; left time: 732.8690s
	iters: 200, epoch: 1 | loss: 0.1949927
	speed: 0.0155s/iter; left time: 345.3972s
	iters: 300, epoch: 1 | loss: 0.2142714
	speed: 0.0141s/iter; left time: 312.3154s
	iters: 400, epoch: 1 | loss: 0.1928869
	speed: 0.0144s/iter; left time: 317.2543s
	iters: 500, epoch: 1 | loss: 0.1939954
	speed: 0.0137s/iter; left time: 301.6734s
	iters: 600, epoch: 1 | loss: 0.2188892
	speed: 0.0136s/iter; left time: 297.4850s
	iters: 700, epoch: 1 | loss: 0.1753346
	speed: 0.0138s/iter; left time: 301.0431s
	iters: 800, epoch: 1 | loss: 0.1827354
	speed: 0.0136s/iter; left time: 293.8867s
	iters: 900, epoch: 1 | loss: 0.1841973
	speed: 0.0141s/iter; left time: 304.8671s
	iters: 1000, epoch: 1 | loss: 0.1943270
	speed: 0.0138s/iter; left time: 295.2006s
	iters: 1100, epoch: 1 | loss: 0.1639996
	speed: 0.0136s/iter; left time: 289.6582s
Epoch: 1 cost time: 17.70219588279724
Epoch: 1, Steps: 1123 | Train Loss: 0.2080826 Vali Loss: 0.1538267 Test Loss: 0.1769536
Validation loss decreased (inf --> 0.153827).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.1741995
	speed: 0.1159s/iter; left time: 2462.3435s
	iters: 200, epoch: 2 | loss: 0.1763752
	speed: 0.0148s/iter; left time: 313.6450s
	iters: 300, epoch: 2 | loss: 0.2165281
	speed: 0.0160s/iter; left time: 336.2560s
	iters: 400, epoch: 2 | loss: 0.1830297
	speed: 0.0148s/iter; left time: 309.0911s
	iters: 500, epoch: 2 | loss: 0.1593252
	speed: 0.0139s/iter; left time: 290.5402s
	iters: 600, epoch: 2 | loss: 0.1890415
	speed: 0.0139s/iter; left time: 288.7821s
	iters: 700, epoch: 2 | loss: 0.1581301
	speed: 0.0139s/iter; left time: 287.9000s
	iters: 800, epoch: 2 | loss: 0.1728549
	speed: 0.0140s/iter; left time: 287.7627s
	iters: 900, epoch: 2 | loss: 0.1731916
	speed: 0.0137s/iter; left time: 279.6614s
	iters: 1000, epoch: 2 | loss: 0.1832649
	speed: 0.0140s/iter; left time: 284.7421s
	iters: 1100, epoch: 2 | loss: 0.1578035
	speed: 0.0139s/iter; left time: 281.6317s
Epoch: 2 cost time: 17.43176579475403
Epoch: 2, Steps: 1123 | Train Loss: 0.1765806 Vali Loss: 0.1535662 Test Loss: 0.1752302
Validation loss decreased (0.153827 --> 0.153566).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.1526057
	speed: 0.1166s/iter; left time: 2346.1423s
	iters: 200, epoch: 3 | loss: 0.1843690
	speed: 0.0137s/iter; left time: 274.0691s
	iters: 300, epoch: 3 | loss: 0.1788423
	speed: 0.0137s/iter; left time: 272.3592s
	iters: 400, epoch: 3 | loss: 0.1698204
	speed: 0.0141s/iter; left time: 278.7658s
	iters: 500, epoch: 3 | loss: 0.2128287
	speed: 0.0138s/iter; left time: 271.7789s
	iters: 600, epoch: 3 | loss: 0.1847647
	speed: 0.0134s/iter; left time: 262.3270s
	iters: 700, epoch: 3 | loss: 0.1801808
	speed: 0.0139s/iter; left time: 270.5430s
	iters: 800, epoch: 3 | loss: 0.1386619
	speed: 0.0137s/iter; left time: 266.8783s
	iters: 900, epoch: 3 | loss: 0.1923284
	speed: 0.0138s/iter; left time: 267.3093s
	iters: 1000, epoch: 3 | loss: 0.1813202
	speed: 0.0140s/iter; left time: 269.2230s
	iters: 1100, epoch: 3 | loss: 0.2025818
	speed: 0.0136s/iter; left time: 259.7069s
Epoch: 3 cost time: 16.859103202819824
Epoch: 3, Steps: 1123 | Train Loss: 0.1710356 Vali Loss: 0.1501062 Test Loss: 0.1727164
Validation loss decreased (0.153566 --> 0.150106).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1910126
	speed: 0.1181s/iter; left time: 2243.3265s
	iters: 200, epoch: 4 | loss: 0.1684767
	speed: 0.0140s/iter; left time: 264.2095s
	iters: 300, epoch: 4 | loss: 0.1481794
	speed: 0.0141s/iter; left time: 265.7073s
	iters: 400, epoch: 4 | loss: 0.1732516
	speed: 0.0142s/iter; left time: 265.1392s
	iters: 500, epoch: 4 | loss: 0.1643399
	speed: 0.0142s/iter; left time: 263.2403s
	iters: 600, epoch: 4 | loss: 0.1608112
	speed: 0.0144s/iter; left time: 266.9663s
	iters: 700, epoch: 4 | loss: 0.1643269
	speed: 0.0146s/iter; left time: 268.4501s
	iters: 800, epoch: 4 | loss: 0.1595601
	speed: 0.0140s/iter; left time: 256.8229s
	iters: 900, epoch: 4 | loss: 0.1682971
	speed: 0.0138s/iter; left time: 251.0752s
	iters: 1000, epoch: 4 | loss: 0.1804800
	speed: 0.0143s/iter; left time: 259.1090s
	iters: 1100, epoch: 4 | loss: 0.1621347
	speed: 0.0145s/iter; left time: 260.8908s
Epoch: 4 cost time: 17.24357008934021
Epoch: 4, Steps: 1123 | Train Loss: 0.1679733 Vali Loss: 0.1481644 Test Loss: 0.1717416
Validation loss decreased (0.150106 --> 0.148164).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1610296
	speed: 0.1178s/iter; left time: 2105.0630s
	iters: 200, epoch: 5 | loss: 0.2234318
	speed: 0.0150s/iter; left time: 266.9361s
	iters: 300, epoch: 5 | loss: 0.2056364
	speed: 0.0148s/iter; left time: 261.6259s
	iters: 400, epoch: 5 | loss: 0.1797712
	speed: 0.0154s/iter; left time: 271.0935s
	iters: 500, epoch: 5 | loss: 0.1704117
	speed: 0.0144s/iter; left time: 250.6951s
	iters: 600, epoch: 5 | loss: 0.1645901
	speed: 0.0142s/iter; left time: 247.2199s
	iters: 700, epoch: 5 | loss: 0.2007872
	speed: 0.0142s/iter; left time: 245.9483s
	iters: 800, epoch: 5 | loss: 0.1940483
	speed: 0.0140s/iter; left time: 239.7663s
	iters: 900, epoch: 5 | loss: 0.2334863
	speed: 0.0142s/iter; left time: 241.8058s
	iters: 1000, epoch: 5 | loss: 0.1506755
	speed: 0.0149s/iter; left time: 252.0726s
	iters: 1100, epoch: 5 | loss: 0.1459800
	speed: 0.0146s/iter; left time: 245.6925s
Epoch: 5 cost time: 17.685948371887207
Epoch: 5, Steps: 1123 | Train Loss: 0.1662962 Vali Loss: 0.1464356 Test Loss: 0.1697182
Validation loss decreased (0.148164 --> 0.146436).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1634181
	speed: 0.1171s/iter; left time: 1960.9701s
	iters: 200, epoch: 6 | loss: 0.1915068
	speed: 0.0138s/iter; left time: 229.3494s
	iters: 300, epoch: 6 | loss: 0.1956576
	speed: 0.0140s/iter; left time: 232.4033s
	iters: 400, epoch: 6 | loss: 0.1629471
	speed: 0.0141s/iter; left time: 232.4508s
	iters: 500, epoch: 6 | loss: 0.1969469
	speed: 0.0145s/iter; left time: 237.7753s
	iters: 600, epoch: 6 | loss: 0.1788427
	speed: 0.0143s/iter; left time: 232.2175s
	iters: 700, epoch: 6 | loss: 0.1526162
	speed: 0.0137s/iter; left time: 220.6647s
	iters: 800, epoch: 6 | loss: 0.1834191
	speed: 0.0136s/iter; left time: 218.7894s
	iters: 900, epoch: 6 | loss: 0.1610605
	speed: 0.0137s/iter; left time: 218.5069s
	iters: 1000, epoch: 6 | loss: 0.1731195
	speed: 0.0141s/iter; left time: 224.0464s
	iters: 1100, epoch: 6 | loss: 0.1795679
	speed: 0.0141s/iter; left time: 221.6552s
Epoch: 6 cost time: 17.077045679092407
Epoch: 6, Steps: 1123 | Train Loss: 0.1653316 Vali Loss: 0.1461051 Test Loss: 0.1690927
Validation loss decreased (0.146436 --> 0.146105).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1875532
	speed: 0.1177s/iter; left time: 1838.8645s
	iters: 200, epoch: 7 | loss: 0.1899389
	speed: 0.0142s/iter; left time: 220.3920s
	iters: 300, epoch: 7 | loss: 0.1692449
	speed: 0.0142s/iter; left time: 219.6362s
	iters: 400, epoch: 7 | loss: 0.1747177
	speed: 0.0140s/iter; left time: 213.9993s
	iters: 500, epoch: 7 | loss: 0.1619317
	speed: 0.0138s/iter; left time: 210.3758s
	iters: 600, epoch: 7 | loss: 0.1289760
	speed: 0.0137s/iter; left time: 207.3976s
	iters: 700, epoch: 7 | loss: 0.1446824
	speed: 0.0140s/iter; left time: 210.7901s
	iters: 800, epoch: 7 | loss: 0.1533043
	speed: 0.0146s/iter; left time: 217.3073s
	iters: 900, epoch: 7 | loss: 0.1662499
	speed: 0.0144s/iter; left time: 213.0008s
	iters: 1000, epoch: 7 | loss: 0.1541199
	speed: 0.0143s/iter; left time: 209.8779s
	iters: 1100, epoch: 7 | loss: 0.1593967
	speed: 0.0137s/iter; left time: 200.8692s
Epoch: 7 cost time: 17.165112257003784
Epoch: 7, Steps: 1123 | Train Loss: 0.1647482 Vali Loss: 0.1455503 Test Loss: 0.1691557
Validation loss decreased (0.146105 --> 0.145550).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1353780
	speed: 0.1175s/iter; left time: 1703.7110s
	iters: 200, epoch: 8 | loss: 0.1922292
	speed: 0.0137s/iter; left time: 197.9586s
	iters: 300, epoch: 8 | loss: 0.1730330
	speed: 0.0140s/iter; left time: 199.5060s
	iters: 400, epoch: 8 | loss: 0.1479467
	speed: 0.0141s/iter; left time: 200.3536s
	iters: 500, epoch: 8 | loss: 0.1776536
	speed: 0.0137s/iter; left time: 193.5104s
	iters: 600, epoch: 8 | loss: 0.1908872
	speed: 0.0139s/iter; left time: 194.7862s
	iters: 700, epoch: 8 | loss: 0.1648227
	speed: 0.0143s/iter; left time: 199.2617s
	iters: 800, epoch: 8 | loss: 0.1505297
	speed: 0.0145s/iter; left time: 199.5199s
	iters: 900, epoch: 8 | loss: 0.1660595
	speed: 0.0141s/iter; left time: 192.5721s
	iters: 1000, epoch: 8 | loss: 0.1844647
	speed: 0.0141s/iter; left time: 191.2673s
	iters: 1100, epoch: 8 | loss: 0.1428487
	speed: 0.0142s/iter; left time: 191.5845s
Epoch: 8 cost time: 17.105889320373535
Epoch: 8, Steps: 1123 | Train Loss: 0.1643893 Vali Loss: 0.1454401 Test Loss: 0.1688636
Validation loss decreased (0.145550 --> 0.145440).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1532905
	speed: 0.1162s/iter; left time: 1554.5454s
	iters: 200, epoch: 9 | loss: 0.1540125
	speed: 0.0142s/iter; left time: 188.6654s
	iters: 300, epoch: 9 | loss: 0.1706710
	speed: 0.0142s/iter; left time: 187.1366s
	iters: 400, epoch: 9 | loss: 0.1516859
	speed: 0.0137s/iter; left time: 179.2918s
	iters: 500, epoch: 9 | loss: 0.1812417
	speed: 0.0136s/iter; left time: 176.0286s
	iters: 600, epoch: 9 | loss: 0.1430667
	speed: 0.0135s/iter; left time: 173.5879s
	iters: 700, epoch: 9 | loss: 0.1641660
	speed: 0.0134s/iter; left time: 171.5832s
	iters: 800, epoch: 9 | loss: 0.1585148
	speed: 0.0139s/iter; left time: 176.4000s
	iters: 900, epoch: 9 | loss: 0.1491078
	speed: 0.0142s/iter; left time: 178.6770s
	iters: 1000, epoch: 9 | loss: 0.2127600
	speed: 0.0147s/iter; left time: 182.9112s
	iters: 1100, epoch: 9 | loss: 0.2382923
	speed: 0.0142s/iter; left time: 175.8026s
Epoch: 9 cost time: 16.994135856628418
Epoch: 9, Steps: 1123 | Train Loss: 0.1642440 Vali Loss: 0.1455186 Test Loss: 0.1689080
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1766151
	speed: 0.1168s/iter; left time: 1431.5532s
	iters: 200, epoch: 10 | loss: 0.1931990
	speed: 0.0145s/iter; left time: 176.7279s
	iters: 300, epoch: 10 | loss: 0.2162764
	speed: 0.0144s/iter; left time: 174.1424s
	iters: 400, epoch: 10 | loss: 0.1599346
	speed: 0.0145s/iter; left time: 172.9029s
	iters: 500, epoch: 10 | loss: 0.1709653
	speed: 0.0143s/iter; left time: 169.8631s
	iters: 600, epoch: 10 | loss: 0.1697376
	speed: 0.0151s/iter; left time: 176.9303s
	iters: 700, epoch: 10 | loss: 0.1539712
	speed: 0.0149s/iter; left time: 174.0593s
	iters: 800, epoch: 10 | loss: 0.2020272
	speed: 0.0150s/iter; left time: 173.0892s
	iters: 900, epoch: 10 | loss: 0.1716896
	speed: 0.0152s/iter; left time: 174.4940s
	iters: 1000, epoch: 10 | loss: 0.1623968
	speed: 0.0143s/iter; left time: 161.8929s
	iters: 1100, epoch: 10 | loss: 0.1611593
	speed: 0.0142s/iter; left time: 159.4830s
Epoch: 10 cost time: 17.71982455253601
Epoch: 10, Steps: 1123 | Train Loss: 0.1641665 Vali Loss: 0.1455463 Test Loss: 0.1690035
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1562116
	speed: 0.1166s/iter; left time: 1298.1446s
	iters: 200, epoch: 11 | loss: 0.1606396
	speed: 0.0140s/iter; left time: 154.1460s
	iters: 300, epoch: 11 | loss: 0.1421125
	speed: 0.0140s/iter; left time: 152.9569s
	iters: 400, epoch: 11 | loss: 0.1501592
	speed: 0.0140s/iter; left time: 151.6277s
	iters: 500, epoch: 11 | loss: 0.1347383
	speed: 0.0139s/iter; left time: 149.2772s
	iters: 600, epoch: 11 | loss: 0.1435083
	speed: 0.0140s/iter; left time: 148.5353s
	iters: 700, epoch: 11 | loss: 0.1714770
	speed: 0.0141s/iter; left time: 148.8747s
	iters: 800, epoch: 11 | loss: 0.2112738
	speed: 0.0139s/iter; left time: 144.6993s
	iters: 900, epoch: 11 | loss: 0.2317148
	speed: 0.0137s/iter; left time: 141.8786s
	iters: 1000, epoch: 11 | loss: 0.1724577
	speed: 0.0135s/iter; left time: 138.0124s
	iters: 1100, epoch: 11 | loss: 0.1639914
	speed: 0.0139s/iter; left time: 140.9946s
Epoch: 11 cost time: 16.996901035308838
Epoch: 11, Steps: 1123 | Train Loss: 0.1641178 Vali Loss: 0.1455059 Test Loss: 0.1689702
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ECL_96_336_TimeLinear_custom_ftM_ttHDDWSY_rda8_rdb1_ksize5_beta0.1_freqh_ebtimeF_bs16_Exp_2020<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.16886363923549652, mae:0.26477158069610596
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_336          Model:              TimeLinear          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.01                
  Des:                Exp                 Loss:               mse                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_336_TimeLinear_custom_ftM_ttHDDWSY_rda8_rdb1_ksize5_beta0.1_freqh_ebtimeF_bs16_Exp_2021>>>>>>>>>>>>>>>>>>>>>>>>>>
Parameters: 228765
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2344659
	speed: 0.0317s/iter; left time: 708.4486s
	iters: 200, epoch: 1 | loss: 0.2422214
	speed: 0.0139s/iter; left time: 308.7173s
	iters: 300, epoch: 1 | loss: 0.2295888
	speed: 0.0135s/iter; left time: 299.6589s
	iters: 400, epoch: 1 | loss: 0.2080549
	speed: 0.0139s/iter; left time: 306.5541s
	iters: 500, epoch: 1 | loss: 0.1810569
	speed: 0.0138s/iter; left time: 302.7099s
	iters: 600, epoch: 1 | loss: 0.1952602
	speed: 0.0133s/iter; left time: 289.7299s
	iters: 700, epoch: 1 | loss: 0.2272273
	speed: 0.0136s/iter; left time: 296.1173s
	iters: 800, epoch: 1 | loss: 0.1589150
	speed: 0.0136s/iter; left time: 294.1396s
	iters: 900, epoch: 1 | loss: 0.1606443
	speed: 0.0134s/iter; left time: 289.6900s
	iters: 1000, epoch: 1 | loss: 0.1875012
	speed: 0.0133s/iter; left time: 286.1854s
	iters: 1100, epoch: 1 | loss: 0.2005104
	speed: 0.0132s/iter; left time: 281.2678s
Epoch: 1 cost time: 17.109124898910522
Epoch: 1, Steps: 1123 | Train Loss: 0.2082308 Vali Loss: 0.1556539 Test Loss: 0.1773961
Validation loss decreased (inf --> 0.155654).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.1681985
	speed: 0.1171s/iter; left time: 2487.7552s
	iters: 200, epoch: 2 | loss: 0.2095921
	speed: 0.0138s/iter; left time: 292.0690s
	iters: 300, epoch: 2 | loss: 0.1671509
	speed: 0.0139s/iter; left time: 291.6263s
	iters: 400, epoch: 2 | loss: 0.1879620
	speed: 0.0136s/iter; left time: 283.7735s
	iters: 500, epoch: 2 | loss: 0.1810234
	speed: 0.0141s/iter; left time: 294.7855s
	iters: 600, epoch: 2 | loss: 0.1910589
	speed: 0.0147s/iter; left time: 305.7515s
	iters: 700, epoch: 2 | loss: 0.1382083
	speed: 0.0144s/iter; left time: 297.8502s
	iters: 800, epoch: 2 | loss: 0.1995345
	speed: 0.0136s/iter; left time: 278.9794s
	iters: 900, epoch: 2 | loss: 0.1510707
	speed: 0.0138s/iter; left time: 282.8759s
	iters: 1000, epoch: 2 | loss: 0.1597736
	speed: 0.0145s/iter; left time: 294.3193s
	iters: 1100, epoch: 2 | loss: 0.1402384
	speed: 0.0137s/iter; left time: 277.2539s
Epoch: 2 cost time: 17.134343147277832
Epoch: 2, Steps: 1123 | Train Loss: 0.1772678 Vali Loss: 0.1538320 Test Loss: 0.1759410
Validation loss decreased (0.155654 --> 0.153832).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.1694809
	speed: 0.1197s/iter; left time: 2407.1498s
	iters: 200, epoch: 3 | loss: 0.1798295
	speed: 0.0140s/iter; left time: 280.1079s
	iters: 300, epoch: 3 | loss: 0.2088182
	speed: 0.0135s/iter; left time: 268.7316s
	iters: 400, epoch: 3 | loss: 0.2350710
	speed: 0.0135s/iter; left time: 267.7235s
	iters: 500, epoch: 3 | loss: 0.1690074
	speed: 0.0141s/iter; left time: 278.5846s
	iters: 600, epoch: 3 | loss: 0.2010212
	speed: 0.0143s/iter; left time: 279.8055s
	iters: 700, epoch: 3 | loss: 0.1504004
	speed: 0.0139s/iter; left time: 272.1840s
	iters: 800, epoch: 3 | loss: 0.1668336
	speed: 0.0139s/iter; left time: 269.6516s
	iters: 900, epoch: 3 | loss: 0.1569876
	speed: 0.0136s/iter; left time: 263.3534s
	iters: 1000, epoch: 3 | loss: 0.1482178
	speed: 0.0136s/iter; left time: 262.1699s
	iters: 1100, epoch: 3 | loss: 0.1930417
	speed: 0.0136s/iter; left time: 260.8803s
Epoch: 3 cost time: 16.91767692565918
Epoch: 3, Steps: 1123 | Train Loss: 0.1719453 Vali Loss: 0.1505988 Test Loss: 0.1738502
Validation loss decreased (0.153832 --> 0.150599).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.1787079
	speed: 0.1186s/iter; left time: 2252.3130s
	iters: 200, epoch: 4 | loss: 0.1705043
	speed: 0.0135s/iter; left time: 254.5469s
	iters: 300, epoch: 4 | loss: 0.1898190
	speed: 0.0136s/iter; left time: 256.0673s
	iters: 400, epoch: 4 | loss: 0.1448528
	speed: 0.0137s/iter; left time: 255.3773s
	iters: 500, epoch: 4 | loss: 0.2023919
	speed: 0.0142s/iter; left time: 264.0852s
	iters: 600, epoch: 4 | loss: 0.1585099
	speed: 0.0139s/iter; left time: 256.8819s
	iters: 700, epoch: 4 | loss: 0.1738408
	speed: 0.0138s/iter; left time: 252.9842s
	iters: 800, epoch: 4 | loss: 0.1535443
	speed: 0.0136s/iter; left time: 248.2239s
	iters: 900, epoch: 4 | loss: 0.1462695
	speed: 0.0137s/iter; left time: 249.8803s
	iters: 1000, epoch: 4 | loss: 0.1673702
	speed: 0.0138s/iter; left time: 250.5531s
	iters: 1100, epoch: 4 | loss: 0.1496009
	speed: 0.0140s/iter; left time: 252.5018s
Epoch: 4 cost time: 16.849172115325928
Epoch: 4, Steps: 1123 | Train Loss: 0.1688944 Vali Loss: 0.1477235 Test Loss: 0.1713776
Validation loss decreased (0.150599 --> 0.147724).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1377334
	speed: 0.1193s/iter; left time: 2131.5774s
	iters: 200, epoch: 5 | loss: 0.1634111
	speed: 0.0138s/iter; left time: 245.6162s
	iters: 300, epoch: 5 | loss: 0.1646469
	speed: 0.0140s/iter; left time: 246.8363s
	iters: 400, epoch: 5 | loss: 0.1741744
	speed: 0.0136s/iter; left time: 238.0918s
	iters: 500, epoch: 5 | loss: 0.1584631
	speed: 0.0137s/iter; left time: 240.0928s
	iters: 600, epoch: 5 | loss: 0.1474778
	speed: 0.0135s/iter; left time: 235.2979s
	iters: 700, epoch: 5 | loss: 0.1642689
	speed: 0.0138s/iter; left time: 239.0334s
	iters: 800, epoch: 5 | loss: 0.1413008
	speed: 0.0138s/iter; left time: 237.7453s
	iters: 900, epoch: 5 | loss: 0.1500925
	speed: 0.0137s/iter; left time: 233.4466s
	iters: 1000, epoch: 5 | loss: 0.1483155
	speed: 0.0139s/iter; left time: 236.2550s
	iters: 1100, epoch: 5 | loss: 0.1665840
	speed: 0.0141s/iter; left time: 237.8186s
Epoch: 5 cost time: 16.88426971435547
Epoch: 5, Steps: 1123 | Train Loss: 0.1671040 Vali Loss: 0.1468567 Test Loss: 0.1699872
Validation loss decreased (0.147724 --> 0.146857).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1649056
	speed: 0.1186s/iter; left time: 1985.9202s
	iters: 200, epoch: 6 | loss: 0.1748756
	speed: 0.0141s/iter; left time: 234.3440s
	iters: 300, epoch: 6 | loss: 0.1682902
	speed: 0.0140s/iter; left time: 231.4917s
	iters: 400, epoch: 6 | loss: 0.2071370
	speed: 0.0140s/iter; left time: 230.8332s
	iters: 500, epoch: 6 | loss: 0.1505122
	speed: 0.0148s/iter; left time: 242.6569s
	iters: 600, epoch: 6 | loss: 0.1873097
	speed: 0.0152s/iter; left time: 246.3302s
	iters: 700, epoch: 6 | loss: 0.1890506
	speed: 0.0142s/iter; left time: 229.4849s
	iters: 800, epoch: 6 | loss: 0.1721388
	speed: 0.0139s/iter; left time: 223.0523s
	iters: 900, epoch: 6 | loss: 0.1581519
	speed: 0.0141s/iter; left time: 224.4409s
	iters: 1000, epoch: 6 | loss: 0.1615777
	speed: 0.0143s/iter; left time: 226.1329s
	iters: 1100, epoch: 6 | loss: 0.1564147
	speed: 0.0138s/iter; left time: 217.1642s
Epoch: 6 cost time: 17.360275506973267
Epoch: 6, Steps: 1123 | Train Loss: 0.1660559 Vali Loss: 0.1462263 Test Loss: 0.1695697
Validation loss decreased (0.146857 --> 0.146226).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1829959
	speed: 0.1197s/iter; left time: 1870.3326s
	iters: 200, epoch: 7 | loss: 0.1978767
	speed: 0.0147s/iter; left time: 227.4772s
	iters: 300, epoch: 7 | loss: 0.1441661
	speed: 0.0143s/iter; left time: 221.0585s
	iters: 400, epoch: 7 | loss: 0.1481393
	speed: 0.0144s/iter; left time: 220.3602s
	iters: 500, epoch: 7 | loss: 0.1563873
	speed: 0.0136s/iter; left time: 206.4308s
	iters: 600, epoch: 7 | loss: 0.2058013
	speed: 0.0136s/iter; left time: 205.6945s
	iters: 700, epoch: 7 | loss: 0.1453231
	speed: 0.0140s/iter; left time: 210.5386s
	iters: 800, epoch: 7 | loss: 0.1497718
	speed: 0.0139s/iter; left time: 208.0929s
	iters: 900, epoch: 7 | loss: 0.1696301
	speed: 0.0135s/iter; left time: 199.9558s
	iters: 1000, epoch: 7 | loss: 0.1377528
	speed: 0.0137s/iter; left time: 202.0187s
	iters: 1100, epoch: 7 | loss: 0.1386227
	speed: 0.0137s/iter; left time: 201.0211s
Epoch: 7 cost time: 17.06562042236328
Epoch: 7, Steps: 1123 | Train Loss: 0.1654331 Vali Loss: 0.1466170 Test Loss: 0.1695138
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1704949
	speed: 0.1175s/iter; left time: 1703.8174s
	iters: 200, epoch: 8 | loss: 0.1453848
	speed: 0.0138s/iter; left time: 198.1875s
	iters: 300, epoch: 8 | loss: 0.1702015
	speed: 0.0142s/iter; left time: 202.4691s
	iters: 400, epoch: 8 | loss: 0.1416150
	speed: 0.0143s/iter; left time: 202.8568s
	iters: 500, epoch: 8 | loss: 0.1774411
	speed: 0.0141s/iter; left time: 199.0410s
	iters: 600, epoch: 8 | loss: 0.1560813
	speed: 0.0141s/iter; left time: 197.0032s
	iters: 700, epoch: 8 | loss: 0.1325521
	speed: 0.0141s/iter; left time: 195.8771s
	iters: 800, epoch: 8 | loss: 0.1631652
	speed: 0.0140s/iter; left time: 193.3385s
	iters: 900, epoch: 8 | loss: 0.1453160
	speed: 0.0141s/iter; left time: 192.5836s
	iters: 1000, epoch: 8 | loss: 0.1543059
	speed: 0.0141s/iter; left time: 191.4474s
	iters: 1100, epoch: 8 | loss: 0.1351555
	speed: 0.0136s/iter; left time: 183.9044s
Epoch: 8 cost time: 17.125590085983276
Epoch: 8, Steps: 1123 | Train Loss: 0.1650650 Vali Loss: 0.1461263 Test Loss: 0.1694618
Validation loss decreased (0.146226 --> 0.146126).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1594851
	speed: 0.1197s/iter; left time: 1601.5944s
	iters: 200, epoch: 9 | loss: 0.1602468
	speed: 0.0140s/iter; left time: 185.3161s
	iters: 300, epoch: 9 | loss: 0.1886644
	speed: 0.0146s/iter; left time: 191.9583s
	iters: 400, epoch: 9 | loss: 0.1913184
	speed: 0.0148s/iter; left time: 193.3895s
	iters: 500, epoch: 9 | loss: 0.1396270
	speed: 0.0145s/iter; left time: 187.9092s
	iters: 600, epoch: 9 | loss: 0.1877469
	speed: 0.0151s/iter; left time: 194.6844s
	iters: 700, epoch: 9 | loss: 0.1668818
	speed: 0.0145s/iter; left time: 185.2021s
	iters: 800, epoch: 9 | loss: 0.1639336
	speed: 0.0139s/iter; left time: 176.4719s
	iters: 900, epoch: 9 | loss: 0.1524722
	speed: 0.0136s/iter; left time: 171.2575s
	iters: 1000, epoch: 9 | loss: 0.1514172
	speed: 0.0143s/iter; left time: 178.5462s
	iters: 1100, epoch: 9 | loss: 0.1793511
	speed: 0.0141s/iter; left time: 174.0431s
Epoch: 9 cost time: 17.40470600128174
Epoch: 9, Steps: 1123 | Train Loss: 0.1649053 Vali Loss: 0.1458913 Test Loss: 0.1693554
Validation loss decreased (0.146126 --> 0.145891).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1367172
	speed: 0.1184s/iter; left time: 1450.3604s
	iters: 200, epoch: 10 | loss: 0.1920369
	speed: 0.0141s/iter; left time: 171.3969s
	iters: 300, epoch: 10 | loss: 0.1613233
	speed: 0.0143s/iter; left time: 172.3771s
	iters: 400, epoch: 10 | loss: 0.1541628
	speed: 0.0143s/iter; left time: 170.8206s
	iters: 500, epoch: 10 | loss: 0.1632518
	speed: 0.0139s/iter; left time: 164.9279s
	iters: 600, epoch: 10 | loss: 0.1767946
	speed: 0.0135s/iter; left time: 158.2476s
	iters: 700, epoch: 10 | loss: 0.1676270
	speed: 0.0138s/iter; left time: 160.3956s
	iters: 800, epoch: 10 | loss: 0.1893869
	speed: 0.0138s/iter; left time: 159.6043s
	iters: 900, epoch: 10 | loss: 0.1403036
	speed: 0.0139s/iter; left time: 159.1721s
	iters: 1000, epoch: 10 | loss: 0.1642930
	speed: 0.0137s/iter; left time: 154.9995s
	iters: 1100, epoch: 10 | loss: 0.2152740
	speed: 0.0140s/iter; left time: 157.8032s
Epoch: 10 cost time: 17.03531789779663
Epoch: 10, Steps: 1123 | Train Loss: 0.1647915 Vali Loss: 0.1460115 Test Loss: 0.1692807
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1331509
	speed: 0.1174s/iter; left time: 1307.1020s
	iters: 200, epoch: 11 | loss: 0.1469624
	speed: 0.0135s/iter; left time: 149.2827s
	iters: 300, epoch: 11 | loss: 0.1469051
	speed: 0.0136s/iter; left time: 148.8858s
	iters: 400, epoch: 11 | loss: 0.1525898
	speed: 0.0137s/iter; left time: 148.5261s
	iters: 500, epoch: 11 | loss: 0.1823863
	speed: 0.0140s/iter; left time: 150.2896s
	iters: 600, epoch: 11 | loss: 0.1506693
	speed: 0.0142s/iter; left time: 151.1981s
	iters: 700, epoch: 11 | loss: 0.1645008
	speed: 0.0141s/iter; left time: 148.2421s
	iters: 800, epoch: 11 | loss: 0.1467643
	speed: 0.0139s/iter; left time: 145.1948s
	iters: 900, epoch: 11 | loss: 0.1627104
	speed: 0.0140s/iter; left time: 144.8776s
	iters: 1000, epoch: 11 | loss: 0.1934558
	speed: 0.0140s/iter; left time: 143.6425s
	iters: 1100, epoch: 11 | loss: 0.1549628
	speed: 0.0143s/iter; left time: 144.6086s
Epoch: 11 cost time: 17.09790062904358
Epoch: 11, Steps: 1123 | Train Loss: 0.1647637 Vali Loss: 0.1459379 Test Loss: 0.1692519
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1669213
	speed: 0.1165s/iter; left time: 1166.1731s
	iters: 200, epoch: 12 | loss: 0.1800210
	speed: 0.0135s/iter; left time: 133.9912s
	iters: 300, epoch: 12 | loss: 0.1853253
	speed: 0.0152s/iter; left time: 148.6402s
	iters: 400, epoch: 12 | loss: 0.1675227
	speed: 0.0149s/iter; left time: 144.6975s
	iters: 500, epoch: 12 | loss: 0.1475767
	speed: 0.0139s/iter; left time: 133.5725s
	iters: 600, epoch: 12 | loss: 0.1466590
	speed: 0.0137s/iter; left time: 130.3369s
	iters: 700, epoch: 12 | loss: 0.1443921
	speed: 0.0138s/iter; left time: 130.1229s
	iters: 800, epoch: 12 | loss: 0.1575650
	speed: 0.0139s/iter; left time: 129.3208s
	iters: 900, epoch: 12 | loss: 0.1498571
	speed: 0.0148s/iter; left time: 136.6368s
	iters: 1000, epoch: 12 | loss: 0.1686450
	speed: 0.0137s/iter; left time: 125.2127s
	iters: 1100, epoch: 12 | loss: 0.1514101
	speed: 0.0140s/iter; left time: 126.4255s
Epoch: 12 cost time: 17.184096813201904
Epoch: 12, Steps: 1123 | Train Loss: 0.1646978 Vali Loss: 0.1459432 Test Loss: 0.1692517
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ECL_96_336_TimeLinear_custom_ftM_ttHDDWSY_rda8_rdb1_ksize5_beta0.1_freqh_ebtimeF_bs16_Exp_2021<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.1693558543920517, mae:0.2651861608028412
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_336          Model:              TimeLinear          

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          0                   
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.0                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.01                
  Des:                Exp                 Loss:               mse                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_336_TimeLinear_custom_ftM_ttHDDWSY_rda8_rdb1_ksize5_beta0.1_freqh_ebtimeF_bs16_Exp_2022>>>>>>>>>>>>>>>>>>>>>>>>>>
Parameters: 228765
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2697516
	speed: 0.0317s/iter; left time: 709.0720s
	iters: 200, epoch: 1 | loss: 0.2419472
	speed: 0.0142s/iter; left time: 317.0292s
	iters: 300, epoch: 1 | loss: 0.1911373
	speed: 0.0141s/iter; left time: 312.5894s
	iters: 400, epoch: 1 | loss: 0.1741692
	speed: 0.0142s/iter; left time: 313.7802s
	iters: 500, epoch: 1 | loss: 0.1678900
	speed: 0.0143s/iter; left time: 314.4412s
	iters: 600, epoch: 1 | loss: 0.1822648
	speed: 0.0138s/iter; left time: 301.6546s
	iters: 700, epoch: 1 | loss: 0.1663872
	speed: 0.0140s/iter; left time: 305.1929s
	iters: 800, epoch: 1 | loss: 0.1790605
	speed: 0.0139s/iter; left time: 301.6139s
	iters: 900, epoch: 1 | loss: 0.1718909
	speed: 0.0154s/iter; left time: 331.1048s
	iters: 1000, epoch: 1 | loss: 0.1917383
	speed: 0.0135s/iter; left time: 289.2307s
	iters: 1100, epoch: 1 | loss: 0.1794176
	speed: 0.0137s/iter; left time: 292.6664s
Epoch: 1 cost time: 17.68441367149353
Epoch: 1, Steps: 1123 | Train Loss: 0.2078819 Vali Loss: 0.1541202 Test Loss: 0.1779653
Validation loss decreased (inf --> 0.154120).  Saving model ...
Updating learning rate to 0.01
	iters: 100, epoch: 2 | loss: 0.1571894
	speed: 0.1175s/iter; left time: 2495.9551s
	iters: 200, epoch: 2 | loss: 0.1784362
	speed: 0.0137s/iter; left time: 289.6187s
	iters: 300, epoch: 2 | loss: 0.1788370
	speed: 0.0140s/iter; left time: 294.6613s
	iters: 400, epoch: 2 | loss: 0.1725756
	speed: 0.0142s/iter; left time: 298.0949s
	iters: 500, epoch: 2 | loss: 0.1568924
	speed: 0.0141s/iter; left time: 293.3832s
	iters: 600, epoch: 2 | loss: 0.1549808
	speed: 0.0140s/iter; left time: 290.7580s
	iters: 700, epoch: 2 | loss: 0.1934389
	speed: 0.0141s/iter; left time: 289.9640s
	iters: 800, epoch: 2 | loss: 0.2207028
	speed: 0.0143s/iter; left time: 294.5690s
	iters: 900, epoch: 2 | loss: 0.1881775
	speed: 0.0142s/iter; left time: 291.1690s
	iters: 1000, epoch: 2 | loss: 0.1898720
	speed: 0.0143s/iter; left time: 289.8342s
	iters: 1100, epoch: 2 | loss: 0.1484501
	speed: 0.0141s/iter; left time: 285.3841s
Epoch: 2 cost time: 17.235439777374268
Epoch: 2, Steps: 1123 | Train Loss: 0.1773297 Vali Loss: 0.1532549 Test Loss: 0.1757788
Validation loss decreased (0.154120 --> 0.153255).  Saving model ...
Updating learning rate to 0.005
	iters: 100, epoch: 3 | loss: 0.1846179
	speed: 0.1201s/iter; left time: 2415.9572s
	iters: 200, epoch: 3 | loss: 0.1538484
	speed: 0.0144s/iter; left time: 287.4543s
	iters: 300, epoch: 3 | loss: 0.1518331
	speed: 0.0139s/iter; left time: 276.6360s
	iters: 400, epoch: 3 | loss: 0.1497163
	speed: 0.0138s/iter; left time: 274.0097s
	iters: 500, epoch: 3 | loss: 0.1670144
	speed: 0.0141s/iter; left time: 278.4976s
	iters: 600, epoch: 3 | loss: 0.1527919
	speed: 0.0144s/iter; left time: 281.9097s
	iters: 700, epoch: 3 | loss: 0.1883066
	speed: 0.0141s/iter; left time: 274.7168s
	iters: 800, epoch: 3 | loss: 0.1639843
	speed: 0.0139s/iter; left time: 269.1889s
	iters: 900, epoch: 3 | loss: 0.1817389
	speed: 0.0142s/iter; left time: 273.9372s
	iters: 1000, epoch: 3 | loss: 0.1569611
	speed: 0.0139s/iter; left time: 267.8676s
	iters: 1100, epoch: 3 | loss: 0.1454258
	speed: 0.0137s/iter; left time: 262.6701s
Epoch: 3 cost time: 17.09601140022278
Epoch: 3, Steps: 1123 | Train Loss: 0.1720667 Vali Loss: 0.1493866 Test Loss: 0.1722236
Validation loss decreased (0.153255 --> 0.149387).  Saving model ...
Updating learning rate to 0.0025
	iters: 100, epoch: 4 | loss: 0.2045146
	speed: 0.1183s/iter; left time: 2245.8422s
	iters: 200, epoch: 4 | loss: 0.1605529
	speed: 0.0137s/iter; left time: 257.9812s
	iters: 300, epoch: 4 | loss: 0.1576262
	speed: 0.0137s/iter; left time: 257.5161s
	iters: 400, epoch: 4 | loss: 0.1643810
	speed: 0.0135s/iter; left time: 253.2437s
	iters: 500, epoch: 4 | loss: 0.1856584
	speed: 0.0141s/iter; left time: 262.5060s
	iters: 600, epoch: 4 | loss: 0.1745159
	speed: 0.0148s/iter; left time: 273.3747s
	iters: 700, epoch: 4 | loss: 0.1561747
	speed: 0.0147s/iter; left time: 270.2627s
	iters: 800, epoch: 4 | loss: 0.1481002
	speed: 0.0138s/iter; left time: 252.4240s
	iters: 900, epoch: 4 | loss: 0.1656884
	speed: 0.0142s/iter; left time: 257.7707s
	iters: 1000, epoch: 4 | loss: 0.1448924
	speed: 0.0145s/iter; left time: 263.0453s
	iters: 1100, epoch: 4 | loss: 0.1892204
	speed: 0.0139s/iter; left time: 249.5222s
Epoch: 4 cost time: 17.149437189102173
Epoch: 4, Steps: 1123 | Train Loss: 0.1689641 Vali Loss: 0.1479308 Test Loss: 0.1712728
Validation loss decreased (0.149387 --> 0.147931).  Saving model ...
Updating learning rate to 0.00125
	iters: 100, epoch: 5 | loss: 0.1427682
	speed: 0.1191s/iter; left time: 2128.0811s
	iters: 200, epoch: 5 | loss: 0.1914168
	speed: 0.0140s/iter; left time: 248.7597s
	iters: 300, epoch: 5 | loss: 0.1663416
	speed: 0.0132s/iter; left time: 233.9977s
	iters: 400, epoch: 5 | loss: 0.1639352
	speed: 0.0136s/iter; left time: 239.6790s
	iters: 500, epoch: 5 | loss: 0.1411080
	speed: 0.0130s/iter; left time: 226.4578s
	iters: 600, epoch: 5 | loss: 0.1214806
	speed: 0.0140s/iter; left time: 243.5975s
	iters: 700, epoch: 5 | loss: 0.1597159
	speed: 0.0139s/iter; left time: 239.5082s
	iters: 800, epoch: 5 | loss: 0.1693764
	speed: 0.0141s/iter; left time: 241.9649s
	iters: 900, epoch: 5 | loss: 0.1651422
	speed: 0.0136s/iter; left time: 232.8472s
	iters: 1000, epoch: 5 | loss: 0.1865975
	speed: 0.0140s/iter; left time: 237.4610s
	iters: 1100, epoch: 5 | loss: 0.1462440
	speed: 0.0133s/iter; left time: 223.9845s
Epoch: 5 cost time: 16.800352811813354
Epoch: 5, Steps: 1123 | Train Loss: 0.1671942 Vali Loss: 0.1466980 Test Loss: 0.1707413
Validation loss decreased (0.147931 --> 0.146698).  Saving model ...
Updating learning rate to 0.000625
	iters: 100, epoch: 6 | loss: 0.1602874
	speed: 0.1186s/iter; left time: 1986.6122s
	iters: 200, epoch: 6 | loss: 0.1805488
	speed: 0.0135s/iter; left time: 223.9473s
	iters: 300, epoch: 6 | loss: 0.1438823
	speed: 0.0136s/iter; left time: 225.7527s
	iters: 400, epoch: 6 | loss: 0.1488780
	speed: 0.0145s/iter; left time: 238.0662s
	iters: 500, epoch: 6 | loss: 0.1534699
	speed: 0.0140s/iter; left time: 229.4274s
	iters: 600, epoch: 6 | loss: 0.1606620
	speed: 0.0139s/iter; left time: 226.5528s
	iters: 700, epoch: 6 | loss: 0.1804694
	speed: 0.0143s/iter; left time: 231.3825s
	iters: 800, epoch: 6 | loss: 0.1757868
	speed: 0.0141s/iter; left time: 226.3659s
	iters: 900, epoch: 6 | loss: 0.1556726
	speed: 0.0146s/iter; left time: 232.4455s
	iters: 1000, epoch: 6 | loss: 0.1798386
	speed: 0.0141s/iter; left time: 224.1934s
	iters: 1100, epoch: 6 | loss: 0.2020447
	speed: 0.0147s/iter; left time: 230.6989s
Epoch: 6 cost time: 17.215343475341797
Epoch: 6, Steps: 1123 | Train Loss: 0.1660445 Vali Loss: 0.1463911 Test Loss: 0.1694209
Validation loss decreased (0.146698 --> 0.146391).  Saving model ...
Updating learning rate to 0.0003125
	iters: 100, epoch: 7 | loss: 0.1488539
	speed: 0.1188s/iter; left time: 1855.8781s
	iters: 200, epoch: 7 | loss: 0.1363226
	speed: 0.0141s/iter; left time: 219.3615s
	iters: 300, epoch: 7 | loss: 0.1547480
	speed: 0.0145s/iter; left time: 224.2760s
	iters: 400, epoch: 7 | loss: 0.1700445
	speed: 0.0143s/iter; left time: 218.5837s
	iters: 500, epoch: 7 | loss: 0.1775819
	speed: 0.0139s/iter; left time: 212.2046s
	iters: 600, epoch: 7 | loss: 0.1657947
	speed: 0.0143s/iter; left time: 216.5332s
	iters: 700, epoch: 7 | loss: 0.1491873
	speed: 0.0144s/iter; left time: 216.3202s
	iters: 800, epoch: 7 | loss: 0.1706427
	speed: 0.0148s/iter; left time: 220.3282s
	iters: 900, epoch: 7 | loss: 0.2437817
	speed: 0.0150s/iter; left time: 221.9165s
	iters: 1000, epoch: 7 | loss: 0.1662171
	speed: 0.0141s/iter; left time: 207.9715s
	iters: 1100, epoch: 7 | loss: 0.1646728
	speed: 0.0138s/iter; left time: 202.0058s
Epoch: 7 cost time: 17.405709505081177
Epoch: 7, Steps: 1123 | Train Loss: 0.1654712 Vali Loss: 0.1458304 Test Loss: 0.1693944
Validation loss decreased (0.146391 --> 0.145830).  Saving model ...
Updating learning rate to 0.00015625
	iters: 100, epoch: 8 | loss: 0.1308542
	speed: 0.1180s/iter; left time: 1710.4784s
	iters: 200, epoch: 8 | loss: 0.1390685
	speed: 0.0142s/iter; left time: 204.2551s
	iters: 300, epoch: 8 | loss: 0.1866044
	speed: 0.0143s/iter; left time: 204.6229s
	iters: 400, epoch: 8 | loss: 0.1813552
	speed: 0.0137s/iter; left time: 195.0623s
	iters: 500, epoch: 8 | loss: 0.1847502
	speed: 0.0143s/iter; left time: 201.5835s
	iters: 600, epoch: 8 | loss: 0.1783308
	speed: 0.0143s/iter; left time: 200.0796s
	iters: 700, epoch: 8 | loss: 0.1453535
	speed: 0.0140s/iter; left time: 194.6588s
	iters: 800, epoch: 8 | loss: 0.1651582
	speed: 0.0141s/iter; left time: 194.6590s
	iters: 900, epoch: 8 | loss: 0.1560826
	speed: 0.0138s/iter; left time: 189.6825s
	iters: 1000, epoch: 8 | loss: 0.1713834
	speed: 0.0138s/iter; left time: 187.4290s
	iters: 1100, epoch: 8 | loss: 0.1559780
	speed: 0.0142s/iter; left time: 192.2104s
Epoch: 8 cost time: 17.185381174087524
Epoch: 8, Steps: 1123 | Train Loss: 0.1651273 Vali Loss: 0.1458167 Test Loss: 0.1691972
Validation loss decreased (0.145830 --> 0.145817).  Saving model ...
Updating learning rate to 7.8125e-05
	iters: 100, epoch: 9 | loss: 0.1865158
	speed: 0.1187s/iter; left time: 1588.4095s
	iters: 200, epoch: 9 | loss: 0.1746488
	speed: 0.0140s/iter; left time: 186.0425s
	iters: 300, epoch: 9 | loss: 0.1640262
	speed: 0.0142s/iter; left time: 186.8689s
	iters: 400, epoch: 9 | loss: 0.1751598
	speed: 0.0137s/iter; left time: 179.5708s
	iters: 500, epoch: 9 | loss: 0.1750758
	speed: 0.0141s/iter; left time: 182.5720s
	iters: 600, epoch: 9 | loss: 0.1289627
	speed: 0.0136s/iter; left time: 174.8968s
	iters: 700, epoch: 9 | loss: 0.1465175
	speed: 0.0145s/iter; left time: 185.6088s
	iters: 800, epoch: 9 | loss: 0.1524216
	speed: 0.0156s/iter; left time: 197.5340s
	iters: 900, epoch: 9 | loss: 0.1469637
	speed: 0.0145s/iter; left time: 181.8459s
	iters: 1000, epoch: 9 | loss: 0.1981267
	speed: 0.0138s/iter; left time: 172.7188s
	iters: 1100, epoch: 9 | loss: 0.1896492
	speed: 0.0138s/iter; left time: 171.3068s
Epoch: 9 cost time: 17.242219924926758
Epoch: 9, Steps: 1123 | Train Loss: 0.1649479 Vali Loss: 0.1457771 Test Loss: 0.1692853
Validation loss decreased (0.145817 --> 0.145777).  Saving model ...
Updating learning rate to 3.90625e-05
	iters: 100, epoch: 10 | loss: 0.1493878
	speed: 0.1188s/iter; left time: 1456.0714s
	iters: 200, epoch: 10 | loss: 0.1606896
	speed: 0.0137s/iter; left time: 166.0240s
	iters: 300, epoch: 10 | loss: 0.1461834
	speed: 0.0146s/iter; left time: 176.3008s
	iters: 400, epoch: 10 | loss: 0.1407559
	speed: 0.0146s/iter; left time: 174.4955s
	iters: 500, epoch: 10 | loss: 0.1241278
	speed: 0.0141s/iter; left time: 167.1437s
	iters: 600, epoch: 10 | loss: 0.1566643
	speed: 0.0145s/iter; left time: 169.9822s
	iters: 700, epoch: 10 | loss: 0.1560462
	speed: 0.0149s/iter; left time: 173.1946s
	iters: 800, epoch: 10 | loss: 0.1505559
	speed: 0.0144s/iter; left time: 166.9218s
	iters: 900, epoch: 10 | loss: 0.1480611
	speed: 0.0141s/iter; left time: 161.5463s
	iters: 1000, epoch: 10 | loss: 0.1751653
	speed: 0.0147s/iter; left time: 167.1245s
	iters: 1100, epoch: 10 | loss: 0.1495961
	speed: 0.0143s/iter; left time: 160.5906s
Epoch: 10 cost time: 17.43316626548767
Epoch: 10, Steps: 1123 | Train Loss: 0.1648397 Vali Loss: 0.1459001 Test Loss: 0.1691551
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-05
	iters: 100, epoch: 11 | loss: 0.1589650
	speed: 0.1177s/iter; left time: 1310.6496s
	iters: 200, epoch: 11 | loss: 0.1611837
	speed: 0.0144s/iter; left time: 158.7936s
	iters: 300, epoch: 11 | loss: 0.1402761
	speed: 0.0149s/iter; left time: 162.9956s
	iters: 400, epoch: 11 | loss: 0.1958338
	speed: 0.0145s/iter; left time: 156.7818s
	iters: 500, epoch: 11 | loss: 0.1405111
	speed: 0.0142s/iter; left time: 152.2219s
	iters: 600, epoch: 11 | loss: 0.1871880
	speed: 0.0140s/iter; left time: 148.7008s
	iters: 700, epoch: 11 | loss: 0.1917152
	speed: 0.0142s/iter; left time: 149.1688s
	iters: 800, epoch: 11 | loss: 0.1648915
	speed: 0.0141s/iter; left time: 146.7554s
	iters: 900, epoch: 11 | loss: 0.1695035
	speed: 0.0153s/iter; left time: 158.1730s
	iters: 1000, epoch: 11 | loss: 0.1351940
	speed: 0.0143s/iter; left time: 146.7541s
	iters: 1100, epoch: 11 | loss: 0.2396926
	speed: 0.0145s/iter; left time: 146.4090s
Epoch: 11 cost time: 17.540758848190308
Epoch: 11, Steps: 1123 | Train Loss: 0.1648249 Vali Loss: 0.1458684 Test Loss: 0.1691930
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-06
	iters: 100, epoch: 12 | loss: 0.1445525
	speed: 0.1180s/iter; left time: 1181.2493s
	iters: 200, epoch: 12 | loss: 0.1477285
	speed: 0.0141s/iter; left time: 139.4375s
	iters: 300, epoch: 12 | loss: 0.1679332
	speed: 0.0139s/iter; left time: 135.9055s
	iters: 400, epoch: 12 | loss: 0.1502253
	speed: 0.0141s/iter; left time: 137.0967s
	iters: 500, epoch: 12 | loss: 0.1576517
	speed: 0.0147s/iter; left time: 140.8994s
	iters: 600, epoch: 12 | loss: 0.1639723
	speed: 0.0154s/iter; left time: 146.6747s
	iters: 700, epoch: 12 | loss: 0.1524091
	speed: 0.0147s/iter; left time: 137.9051s
	iters: 800, epoch: 12 | loss: 0.1602346
	speed: 0.0145s/iter; left time: 134.8069s
	iters: 900, epoch: 12 | loss: 0.1668445
	speed: 0.0138s/iter; left time: 126.6297s
	iters: 1000, epoch: 12 | loss: 0.1749443
	speed: 0.0139s/iter; left time: 126.4521s
	iters: 1100, epoch: 12 | loss: 0.1737465
	speed: 0.0143s/iter; left time: 128.6219s
Epoch: 12 cost time: 17.35591745376587
Epoch: 12, Steps: 1123 | Train Loss: 0.1647709 Vali Loss: 0.1458353 Test Loss: 0.1691710
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ECL_96_336_TimeLinear_custom_ftM_ttHDDWSY_rda8_rdb1_ksize5_beta0.1_freqh_ebtimeF_bs16_Exp_2022<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.16928742825984955, mae:0.26496484875679016
